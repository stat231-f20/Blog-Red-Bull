---
title: "Quarterback Social Media Activity vs. Performance"
author: "John Koomson, Jack Dove, and Michael Pitts"
date: "11/10/20"
output:
  rmdformats::readthedown:
    thumbnails: false
    highlight: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
library(tidyverse)
library(readr)
library(robotstxt)
library(rvest)
library(knitr)
library(rtweet)
library(janitor)
library(shiny)
library(readxl)
library(mosaic)
library(gridExtra)
library(plotly)
library(DT)


key <- readLines("~/Desktop/Data Science/Stat231JackDove/Homeworks/twitterAPI")
key
```

```{r, echo=FALSE, include=FALSE}
#Roethlisberger, Jones, Bridgewater, Mayfield, Minshew, Wilson, Brees, Murray

#BEN ROETHLISBERGER

#Load gamelogs data
Ben_Roethlisberger <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/Ben_Roethlisberger.xlsx")

#Wrangle gamelogs data
Ben_Roethlisberger_logs <- Ben_Roethlisberger %>%
  mutate(total_yards = pyds + ryds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pyds + 0.1*ryds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n())) %>%
  filter(Week <=7)

#Dates from Game Logs (used in merge with twitter data)
Ben_Roethlisberger_dates <- Ben_Roethlisberger_logs %>%
  select(Date)

#Twitter Scrape of Tweets
Ben_Roethlisberger_tweets <- get_timeline("@_BigBen7", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(Ben_Roethlisberger_dates$Date[1]), 1, 
              ifelse(date > as.Date(Ben_Roethlisberger_dates$Date[1]) & date <= as.Date(Ben_Roethlisberger_dates$Date[2]), 2,
                     ifelse(date > as.Date(Ben_Roethlisberger_dates$Date[2]) & date <= as.Date(Ben_Roethlisberger_dates$Date[3]), 3,
                            ifelse(date > as.Date(Ben_Roethlisberger_dates$Date[3]) & date <= as.Date(Ben_Roethlisberger_dates$Date[4]), 4,
                                   ifelse(date > as.Date(Ben_Roethlisberger_dates$Date[4]) & date <= as.Date(Ben_Roethlisberger_dates$Date[5]), 5,
                                          ifelse(date > as.Date(Ben_Roethlisberger_dates$Date[5]) & date <= as.Date(Ben_Roethlisberger_dates$Date[6]), 6,
                                                 ifelse(date > as.Date(Ben_Roethlisberger_dates$Date[6]) & date <= as.Date(Ben_Roethlisberger_dates$Date[7]), 7, "error")))))))
                                        
  )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())

#Combined football and twitter data
Ben_Roethlisberger_data <- Ben_Roethlisberger_tweets %>%
  left_join(Ben_Roethlisberger_logs, by="Week") %>%
  mutate(player = "Ben Roethlisberger")


#DANIEL JONES

#Load gamelogs data
Daniel_Jones <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/Daniel_Jones.xlsx")

#Wrangle gamelogs data
Daniel_Jones_logs <- Daniel_Jones %>%
  mutate(total_yards = pyds + ryds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pyds + 0.1*ryds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n())) %>%
  filter(Week <=7)

#Dates from Game Logs (used in merge with twitter data)
Daniel_Jones_dates <- Daniel_Jones_logs %>%
  select(Date)

#Twitter Scrape of Tweets
Daniel_Jones_tweets <- get_timeline("@Daniel_Jones10", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(Daniel_Jones_dates$Date[1]), 1, 
                             ifelse(date > as.Date(Daniel_Jones_dates$Date[1]) & date <= as.Date(Daniel_Jones_dates$Date[2]), 2,
                                    ifelse(date > as.Date(Daniel_Jones_dates$Date[2]) & date <= as.Date(Daniel_Jones_dates$Date[3]), 3,
                                           ifelse(date > as.Date(Daniel_Jones_dates$Date[3]) & date <= as.Date(Daniel_Jones_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(Daniel_Jones_dates$Date[4]) & date <= as.Date(Daniel_Jones_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(Daniel_Jones_dates$Date[5]) & date <= as.Date(Daniel_Jones_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(Daniel_Jones_dates$Date[6]) & date <= as.Date(Daniel_Jones_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())

#Combined football and twitter data NOTE: DOES NOT WORK SINCE ZERO TWEETS SINCE SEPT 1
Daniel_Jones_data <- Daniel_Jones_tweets %>%
  left_join(Daniel_Jones_logs, by="Week") %>%
  mutate(player = "Daniel Jones")

#TEDDY BRIDGEWATER

#Load gamelogs data
Teddy_Bridgewater <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/Teddy_Bridgewater.xlsx")

#Wrangle gamelogs data
Teddy_Bridgewater_logs <- Teddy_Bridgewater %>%
  mutate(total_yards = pyds + ryds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pyds + 0.1*ryds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n())) %>%
  filter(Week <=7)

#Dates from Game Logs (used in merge with twitter data)
Teddy_Bridgewater_dates <- Teddy_Bridgewater_logs %>%
  select(Date)

#Twitter Scrape of Tweets
Teddy_Bridgewater_tweets <- get_timeline("@teddyb_h2o", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(Teddy_Bridgewater_dates$Date[1]), 1, 
                             ifelse(date > as.Date(Teddy_Bridgewater_dates$Date[1]) & date <= as.Date(Teddy_Bridgewater_dates$Date[2]), 2,
                                    ifelse(date > as.Date(Teddy_Bridgewater_dates$Date[2]) & date <= as.Date(Teddy_Bridgewater_dates$Date[3]), 3,
                                           ifelse(date > as.Date(Teddy_Bridgewater_dates$Date[3]) & date <= as.Date(Teddy_Bridgewater_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(Teddy_Bridgewater_dates$Date[4]) & date <= as.Date(Teddy_Bridgewater_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(Teddy_Bridgewater_dates$Date[5]) & date <= as.Date(Teddy_Bridgewater_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(Teddy_Bridgewater_dates$Date[6]) & date <= as.Date(Teddy_Bridgewater_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())

#Combined football and twitter data
Teddy_Bridgewater_data <- Teddy_Bridgewater_tweets %>%
  left_join(Teddy_Bridgewater_logs, by="Week") %>%
  mutate(player = "Teddy Bridgewater")


#BAKER MAYFIELD

#Load gamelogs data
Baker_Mayfield <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/Baker_Mayfield.xlsx")

#Wrangle gamelogs data
Baker_Mayfield_logs <- Baker_Mayfield %>%
  mutate(total_yards = pyds + ryds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pyds + 0.1*ryds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n())) %>%
  filter(Week <=7)

#Dates from Game Logs (used in merge with twitter data)
Baker_Mayfield_dates <- Baker_Mayfield_logs %>%
  select(Date)

#Twitter Scrape of Tweets
Baker_Mayfield_tweets <- get_timeline("@bakermayfield", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(Baker_Mayfield_dates$Date[1]), 1, 
                             ifelse(date > as.Date(Baker_Mayfield_dates$Date[1]) & date <= as.Date(Baker_Mayfield_dates$Date[2]), 2,
                                    ifelse(date > as.Date(Baker_Mayfield_dates$Date[2]) & date <= as.Date(Baker_Mayfield_dates$Date[3]), 3,
                                           ifelse(date > as.Date(Baker_Mayfield_dates$Date[3]) & date <= as.Date(Baker_Mayfield_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(Baker_Mayfield_dates$Date[4]) & date <= as.Date(Baker_Mayfield_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(Baker_Mayfield_dates$Date[5]) & date <= as.Date(Baker_Mayfield_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(Baker_Mayfield_dates$Date[6]) & date <= as.Date(Baker_Mayfield_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())

#Combined football and twitter data
Baker_Mayfield_data <- Baker_Mayfield_tweets %>%
  left_join(Baker_Mayfield_logs, by="Week") %>%
  mutate(player = "Baker Mayfield")


#GARDNER MINSHEW

#Load gamelogs data
Gardner_Minshew <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/Gardner_Minshew.xlsx")

#Wrangle gamelogs data
Gardner_Minshew_logs <- Gardner_Minshew %>%
  mutate(total_yards = pyds + ryds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pyds + 0.1*ryds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n())) %>%
  filter(Week <=7)

#Dates from Game Logs (used in merge with twitter data)
Gardner_Minshew_dates <- Gardner_Minshew_logs %>%
  select(Date)

#Twitter Scrape of Tweets
Gardner_Minshew_tweets <- get_timeline("@GardnerMinshew5", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(Gardner_Minshew_dates$Date[1]), 1, 
                             ifelse(date > as.Date(Gardner_Minshew_dates$Date[1]) & date <= as.Date(Gardner_Minshew_dates$Date[2]), 2,
                                    ifelse(date > as.Date(Gardner_Minshew_dates$Date[2]) & date <= as.Date(Gardner_Minshew_dates$Date[3]), 3,
                                           ifelse(date > as.Date(Gardner_Minshew_dates$Date[3]) & date <= as.Date(Gardner_Minshew_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(Gardner_Minshew_dates$Date[4]) & date <= as.Date(Gardner_Minshew_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(Gardner_Minshew_dates$Date[5]) & date <= as.Date(Gardner_Minshew_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(Gardner_Minshew_dates$Date[6]) & date <= as.Date(Gardner_Minshew_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())

#Combined football and twitter data
Gardner_Minshew_data <- Gardner_Minshew_tweets %>%
  left_join(Gardner_Minshew_logs, by="Week") %>%
  mutate(player = "Gardner Minshew")


#RUSSELL WILSON

#Load gamelogs data
Russell_Wilson <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/Russell_Wilson.xlsx")

#Wrangle gamelogs data
Russell_Wilson_logs <- Russell_Wilson %>%
  mutate(total_yards = pyds + ryds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pyds + 0.1*ryds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n())) %>%
  filter(Week <=7)

#Dates from Game Logs (used in merge with twitter data)
Russell_Wilson_dates <- Russell_Wilson_logs %>%
  select(Date)

#Twitter Scrape of Tweets
Russell_Wilson_tweets <- get_timeline("@DangeRussWilson", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(Russell_Wilson_dates$Date[1]), 1, 
                             ifelse(date > as.Date(Russell_Wilson_dates$Date[1]) & date <= as.Date(Russell_Wilson_dates$Date[2]), 2,
                                    ifelse(date > as.Date(Russell_Wilson_dates$Date[2]) & date <= as.Date(Russell_Wilson_dates$Date[3]), 3,
                                           ifelse(date > as.Date(Russell_Wilson_dates$Date[3]) & date <= as.Date(Russell_Wilson_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(Russell_Wilson_dates$Date[4]) & date <= as.Date(Russell_Wilson_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(Russell_Wilson_dates$Date[5]) & date <= as.Date(Russell_Wilson_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(Russell_Wilson_dates$Date[6]) & date <= as.Date(Russell_Wilson_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())

#Combined football and twitter data
Russell_Wilson_data <- Russell_Wilson_tweets %>%
  left_join(Russell_Wilson_logs, by="Week") %>%
  mutate(player = "Russell Wilson")


#DREW BREES

#Load gamelogs data
Drew_Brees <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/Drew_Brees.xlsx")

#Wrangle gamelogs data
Drew_Brees_logs <- Drew_Brees %>%
  mutate(total_yards = pyds + ryds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pyds + 0.1*ryds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n())) %>%
  filter(Week <=7)

#Dates from Game Logs (used in merge with twitter data)
Drew_Brees_dates <- Drew_Brees_logs %>%
  select(Date)

#Twitter Scrape of Tweets
Drew_Brees_tweets <- get_timeline("@drewbrees", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(Drew_Brees_dates$Date[1]), 1, 
                             ifelse(date > as.Date(Drew_Brees_dates$Date[1]) & date <= as.Date(Drew_Brees_dates$Date[2]), 2,
                                    ifelse(date > as.Date(Drew_Brees_dates$Date[2]) & date <= as.Date(Drew_Brees_dates$Date[3]), 3,
                                           ifelse(date > as.Date(Drew_Brees_dates$Date[3]) & date <= as.Date(Drew_Brees_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(Drew_Brees_dates$Date[4]) & date <= as.Date(Drew_Brees_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(Drew_Brees_dates$Date[5]) & date <= as.Date(Drew_Brees_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(Drew_Brees_dates$Date[6]) & date <= as.Date(Drew_Brees_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())

#Combined football and twitter data
Drew_Brees_data <- Drew_Brees_tweets %>%
  left_join(Drew_Brees_logs, by="Week") %>%
  mutate(player = "Drew Brees")


#KYLER MURRAY

#Load gamelogs data
Kyler_Murray <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/Kyler_Murray.xlsx")

#Wrangle gamelogs data
Kyler_Murray_logs <- Kyler_Murray %>%
  mutate(total_yards = pyds + ryds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pyds + 0.1*ryds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n())) %>%
  filter(Week <=7)

#Dates from Game Logs (used in merge with twitter data)
Kyler_Murray_dates <- Kyler_Murray_logs %>%
  select(Date)

#Twitter Scrape of Tweets
Kyler_Murray_tweets <- get_timeline("@K1", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(Kyler_Murray_dates$Date[1]), 1, 
                             ifelse(date > as.Date(Kyler_Murray_dates$Date[1]) & date <= as.Date(Kyler_Murray_dates$Date[2]), 2,
                                    ifelse(date > as.Date(Kyler_Murray_dates$Date[2]) & date <= as.Date(Kyler_Murray_dates$Date[3]), 3,
                                           ifelse(date > as.Date(Kyler_Murray_dates$Date[3]) & date <= as.Date(Kyler_Murray_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(Kyler_Murray_dates$Date[4]) & date <= as.Date(Kyler_Murray_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(Kyler_Murray_dates$Date[5]) & date <= as.Date(Kyler_Murray_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(Kyler_Murray_dates$Date[6]) & date <= as.Date(Kyler_Murray_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())

#Combined football and twitter data
Kyler_Murray_data <- Kyler_Murray_tweets %>%
  left_join(Kyler_Murray_logs, by="Week") %>%
  mutate(player = "Kyler Murray")


#JOE BURROW

#Load gamelogs data
joe_burrow <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/joe_burrow.xls")
#Wrangle gamelogs data
joe_burrow_logs <- joe_burrow %>%
  mutate(total_yards = PYds + RYds) %>%
  mutate(total_tds = PTD + RTD) %>%
  mutate(fpts = 4*PTD + 6*RTD + .04*PYds + 0.1*RYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
joe_burrow_dates <- joe_burrow_logs %>%
  select(Date)
#Twitter Scrape of Tweets
joe_burrow_tweets <- get_timeline("@joeyb", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(joe_burrow_dates$Date[1]), 1, 
                             ifelse(date > as.Date(joe_burrow_dates$Date[1]) & 
                                      date <= as.Date(joe_burrow_dates$Date[2]), 2,
                                    ifelse(date > as.Date(joe_burrow_dates$Date[2]) & 
                                             date <= as.Date(joe_burrow_dates$Date[3]), 3,
                                           ifelse(date > as.Date(joe_burrow_dates$Date[3]) & 
                                                    date <= as.Date(joe_burrow_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(joe_burrow_dates$Date[4]) & 
                                                           date <= as.Date(joe_burrow_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(joe_burrow_dates$Date[5]) & 
                                                                  date <= as.Date(joe_burrow_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(joe_burrow_dates$Date[6]) & 
                                                                         date <= as.Date(joe_burrow_dates$Date[7]), 7,
                                                                       ifelse(date > as.Date(joe_burrow_dates$Date[7]) & 
                                                                                date <= as.Date(joe_burrow_dates$Date[8]), 8, "error")
                                                                )))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
joe_burrow_data <- joe_burrow_tweets %>%
  left_join(joe_burrow_logs, by="Week") %>%
  mutate(player = "Joe Burrow")


# MATT RYAN


#Load gamelogs data
matt_ryan <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/matt_ryan.xls")
#Wrangle gamelogs data
matt_ryan_logs <- matt_ryan %>%
  mutate(total_yards = PYds + RYds) %>%
  mutate(total_tds = PTD + RTD) %>%
  mutate(fpts = 4*PTD + 6*RTD + .04*PYds + 0.1*RYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
matt_ryan_dates <- matt_ryan_logs %>%
  select(Date)
#Twitter Scrape of Tweets
matt_ryan_tweets <- get_timeline("m_ryan02", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(matt_ryan_dates$Date[1]), 1, 
                             ifelse(date > as.Date(matt_ryan_dates$Date[1]) & 
                                      date <= as.Date(matt_ryan_dates$Date[2]), 2,
                                    ifelse(date > as.Date(matt_ryan_dates$Date[2]) & 
                                             date <= as.Date(matt_ryan_dates$Date[3]), 3,
                                           ifelse(date > as.Date(matt_ryan_dates$Date[3]) & 
                                                    date <= as.Date(matt_ryan_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(matt_ryan_dates$Date[4]) & 
                                                           date <= as.Date(matt_ryan_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(matt_ryan_dates$Date[5]) & 
                                                                  date <= as.Date(matt_ryan_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(matt_ryan_dates$Date[6]) & 
                                                                         date <= as.Date(matt_ryan_dates$Date[7]), 7,
                                                                       ifelse(date > as.Date(matt_ryan_dates$Date[7]) & 
                                                                                date <= as.Date(matt_ryan_dates$Date[8]), 8, "error")
                                                                )))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
matt_ryan_data <- matt_ryan_tweets %>%
  left_join(matt_ryan_logs, by="Week") %>%
  mutate(player = "Matt Ryan")



# Tom Brady


#Load gamelogs data
tom_brady <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/tom_brady.xls")
#Wrangle gamelogs data
tom_brady_logs <- tom_brady %>%
  mutate(total_yards = PYds + RYds) %>%
  mutate(total_tds = PTD + RTD) %>%
  mutate(fpts = 4*PTD + 6*RTD + .04*PYds + 0.1*RYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
tom_brady_dates <- tom_brady_logs %>%
  select(Date)
#Twitter Scrape of Tweets
tom_brady_tweets <- get_timeline("tombrady", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(tom_brady_dates$Date[1]), 1, 
                             ifelse(date > as.Date(tom_brady_dates$Date[1]) & 
                                      date <= as.Date(tom_brady_dates$Date[2]), 2,
                                    ifelse(date > as.Date(tom_brady_dates$Date[2]) & 
                                             date <= as.Date(tom_brady_dates$Date[3]), 3,
                                           ifelse(date > as.Date(tom_brady_dates$Date[3]) & 
                                                    date <= as.Date(tom_brady_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(tom_brady_dates$Date[4]) & 
                                                           date <= as.Date(tom_brady_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(tom_brady_dates$Date[5]) & 
                                                                  date <= as.Date(tom_brady_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(tom_brady_dates$Date[6]) & 
                                                                         date <= as.Date(tom_brady_dates$Date[7]), 7,
                                                                       ifelse(date > as.Date(tom_brady_dates$Date[7]) & 
                                                                                date <= as.Date(tom_brady_dates$Date[8]), 8, "error")
                                                                )))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
tom_brady_data <- tom_brady_tweets %>%
  left_join(tom_brady_logs, by="Week") %>%
  mutate(player = "Tom Brady")



# Carson Wentz


#Load gamelogs data
carson_wentz <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/carson_wentz.xls")
#Wrangle gamelogs data
carson_wentz_logs <- carson_wentz %>%
  mutate(total_yards = PYds + RYds) %>%
  mutate(total_tds = PTD + RTD) %>%
  mutate(fpts = 4*PTD + 6*RTD + .04*PYds + 0.1*RYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
carson_wentz_dates <- carson_wentz_logs %>%
  select(Date)
#Twitter Scrape of Tweets
carson_wentz_tweets <- get_timeline("@cj_wentz", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(carson_wentz_dates$Date[1]), 1, 
                             ifelse(date > as.Date(carson_wentz_dates$Date[1]) & 
                                      date <= as.Date(carson_wentz_dates$Date[2]), 2,
                                    ifelse(date > as.Date(carson_wentz_dates$Date[2]) & 
                                             date <= as.Date(carson_wentz_dates$Date[3]), 3,
                                           ifelse(date > as.Date(carson_wentz_dates$Date[3]) & 
                                                    date <= as.Date(carson_wentz_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(carson_wentz_dates$Date[4]) & 
                                                           date <= as.Date(carson_wentz_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(carson_wentz_dates$Date[5]) & 
                                                                  date <= as.Date(carson_wentz_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(carson_wentz_dates$Date[6]) & 
                                                                         date <= as.Date(carson_wentz_dates$Date[7]), 7,
                                                                       ifelse(date > as.Date(carson_wentz_dates$Date[7]) & 
                                                                                date <= as.Date(carson_wentz_dates$Date[8]), 8, "error")
                                                                )))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
carson_wentz_data <- carson_wentz_tweets %>%
  left_join(carson_wentz_logs, by="Week") %>%
  mutate(player = "Carson Wentz")




# Jared Goff


#Load gamelogs data
jared_goff <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/jared_goff.xls")
#Wrangle gamelogs data
jared_goff_logs <- jared_goff %>%
  mutate(total_yards = PYds + RYds) %>%
  mutate(total_tds = PTD + RTD) %>%
  mutate(fpts = 4*PTD + 6*RTD + .04*PYds + 0.1*RYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts)%>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
jared_goff_dates <- jared_goff_logs %>%
  select(Date)
#Twitter Scrape of Tweets
jared_goff_tweets <- get_timeline("@jaredgoff16", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(jared_goff_dates$Date[1]), 1, 
                             ifelse(date > as.Date(jared_goff_dates$Date[1]) & 
                                      date <= as.Date(jared_goff_dates$Date[2]), 2,
                                    ifelse(date > as.Date(jared_goff_dates$Date[2]) & 
                                             date <= as.Date(jared_goff_dates$Date[3]), 3,
                                           ifelse(date > as.Date(jared_goff_dates$Date[3]) & 
                                                    date <= as.Date(jared_goff_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(jared_goff_dates$Date[4]) & 
                                                           date <= as.Date(jared_goff_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(jared_goff_dates$Date[5]) & 
                                                                  date <= as.Date(jared_goff_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(jared_goff_dates$Date[6]) & 
                                                                         date <= as.Date(jared_goff_dates$Date[7]), 7,
                                                                       ifelse(date > as.Date(jared_goff_dates$Date[7]) & 
                                                                                date <= as.Date(jared_goff_dates$Date[8]), 8, "error")
                                                                )))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
jared_goff_data <- jared_goff_tweets %>%
  left_join(jared_goff_logs, by="Week") %>%
  mutate(player = "Jared Goff")




# Patrick Mahomes


#Load gamelogs data
patrick_mahomes <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/patrick_mahomes.xls")
#Wrangle gamelogs data
patrick_mahomes_logs <- patrick_mahomes %>%
  mutate(total_yards = PYds + RYds) %>%
  mutate(total_tds = PTD + RTD) %>%
  mutate(fpts = 4*PTD + 6*RTD + .04*PYds + 0.1*RYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
patrick_mahomes_dates <- patrick_mahomes_logs %>%
  select(Date)
#Twitter Scrape of Tweets
patrick_mahomes_tweets <- get_timeline("@patrickmahomes", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(patrick_mahomes_dates$Date[1]), 1, 
                             ifelse(date > as.Date(patrick_mahomes_dates$Date[1]) & 
                                      date <= as.Date(patrick_mahomes_dates$Date[2]), 2,
                                    ifelse(date > as.Date(patrick_mahomes_dates$Date[2]) & 
                                             date <= as.Date(patrick_mahomes_dates$Date[3]), 3,
                                           ifelse(date > as.Date(patrick_mahomes_dates$Date[3]) & 
                                                    date <= as.Date(patrick_mahomes_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(patrick_mahomes_dates$Date[4]) & 
                                                           date <= as.Date(patrick_mahomes_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(patrick_mahomes_dates$Date[5]) & 
                                                                  date <= as.Date(patrick_mahomes_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(patrick_mahomes_dates$Date[6]) & 
                                                                         date <= as.Date(patrick_mahomes_dates$Date[7]), 7,
                                                                       ifelse(date > as.Date(patrick_mahomes_dates$Date[7]) & 
                                                                                date <= as.Date(patrick_mahomes_dates$Date[8]), 8, "error")
                                                                )))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
patrick_mahomes_data <- patrick_mahomes_tweets %>%
  left_join(patrick_mahomes_logs, by="Week") %>%
  mutate(player = "Patrick Mahomes")



# Aaron Rodgers

#Load gamelogs data
aaron_rodgers <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/aaron_rodgers.xls")
#Wrangle gamelogs data
aaron_rodgers_logs <- aaron_rodgers %>%
  mutate(total_yards = PYds + RYds) %>%
  mutate(total_tds = PTD + RTD) %>%
  mutate(fpts = 4*PTD + 6*RTD + .04*PYds + 0.1*RYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
aaron_rodgers_dates <- aaron_rodgers_logs %>%
  select(Date)
#Twitter Scrape of Tweets
aaron_rodgers_tweets <- get_timeline("@aaronrodgers12", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(aaron_rodgers_dates$Date[1]), 1, 
                             ifelse(date > as.Date(aaron_rodgers_dates$Date[1]) & 
                                      date <= as.Date(aaron_rodgers_dates$Date[2]), 2,
                                    ifelse(date > as.Date(aaron_rodgers_dates$Date[2]) & 
                                             date <= as.Date(aaron_rodgers_dates$Date[3]), 3,
                                           ifelse(date > as.Date(aaron_rodgers_dates$Date[3]) & 
                                                    date <= as.Date(aaron_rodgers_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(aaron_rodgers_dates$Date[4]) & 
                                                           date <= as.Date(aaron_rodgers_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(aaron_rodgers_dates$Date[5]) & 
                                                                  date <= as.Date(aaron_rodgers_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(aaron_rodgers_dates$Date[6]) & 
                                                                         date <= as.Date(aaron_rodgers_dates$Date[7]), 7,
                                                                       ifelse(date > as.Date(aaron_rodgers_dates$Date[7]) & 
                                                                                date <= as.Date(aaron_rodgers_dates$Date[8]), 8, "error")
                                                                )))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
aaron_rodgers_data <- aaron_rodgers_tweets %>%
  left_join(aaron_rodgers_logs, by="Week") %>%
  mutate(player = "Aaron Rodgers")



# Josh Allen


#Load gamelogs data
josh_allen <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/josh_allen.xls")
#Wrangle gamelogs data
josh_allen_logs <- josh_allen %>%
  mutate(total_yards = PYds + RYds) %>%
  mutate(total_tds = PTD + RTD) %>%
  mutate(fpts = 4*PTD + 6*RTD + .04*PYds + 0.1*RYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
josh_allen_dates <- josh_allen_logs %>%
  select(Date)
#Twitter Scrape of Tweets
josh_allen_tweets <- get_timeline("@joshallenqb", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(josh_allen_dates$Date[1]), 1, 
                             ifelse(date > as.Date(josh_allen_dates$Date[1]) & 
                                      date <= as.Date(josh_allen_dates$Date[2]), 2,
                                    ifelse(date > as.Date(josh_allen_dates$Date[2]) & 
                                             date <= as.Date(josh_allen_dates$Date[3]), 3,
                                           ifelse(date > as.Date(josh_allen_dates$Date[3]) & 
                                                    date <= as.Date(josh_allen_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(josh_allen_dates$Date[4]) & 
                                                           date <= as.Date(josh_allen_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(josh_allen_dates$Date[5]) & 
                                                                  date <= as.Date(josh_allen_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(josh_allen_dates$Date[6]) & 
                                                                         date <= as.Date(josh_allen_dates$Date[7]), 7,
                                                                       ifelse(date > as.Date(josh_allen_dates$Date[7]) & 
                                                                                date <= as.Date(josh_allen_dates$Date[8]), 8, "error")
                                                                )))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
josh_allen_data <- josh_allen_tweets %>%
  left_join(josh_allen_logs, by="Week") %>%
  mutate(player = "Josh Allen")


#DEREK CARR
derek_carr <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/derek_carr.xlsx")    
#Wrangle gamelogs data
derek_carr_logs <- derek_carr %>%
  mutate(total_yards = pYds + rYds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pYds + 0.1*rYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
derek_carr_dates <- derek_carr_logs %>%
  select(Date)
#Twitter Scrape of Tweets
derek_carr_tweets <- get_timeline("@derekcarrqb", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(derek_carr_dates$Date[1]), 1, 
                             ifelse(date > as.Date(derek_carr_dates$Date[1]) & date <= as.Date(derek_carr_dates$Date[2]), 2,
                                    ifelse(date > as.Date(derek_carr_dates$Date[2]) & date <= as.Date(derek_carr_dates$Date[3]), 3,
                                           ifelse(date > as.Date(derek_carr_dates$Date[3]) & date <= as.Date(derek_carr_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(derek_carr_dates$Date[4]) & date <= as.Date(derek_carr_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(derek_carr_dates$Date[5]) & date <= as.Date(derek_carr_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(derek_carr_dates$Date[6]) & date <= as.Date(derek_carr_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n()) 
#Combined football and twitter data
derek_carr_data <- derek_carr_tweets %>%
  left_join(derek_carr_logs, by="Week") %>%
  mutate(player="Derek Carr")


#KIRK COUSINS
kirk_cousins <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/kirk_cousins.xlsx")    
#Wrangle gamelogs data
kirk_cousins_logs <- kirk_cousins %>%
  mutate(total_yards = pYds + rYds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pYds + 0.1*rYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
kirk_cousins_dates <- kirk_cousins_logs %>%
  select(Date)
#Twitter Scrape of Tweets
kirk_cousins_tweets <- get_timeline("@KirkCousins8", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(kirk_cousins_dates$Date[1]), 1, 
                             ifelse(date > as.Date(kirk_cousins_dates$Date[1]) & date <= as.Date(kirk_cousins_dates$Date[2]), 2,
                                    ifelse(date > as.Date(kirk_cousins_dates$Date[2]) & date <= as.Date(kirk_cousins_dates$Date[3]), 3,
                                           ifelse(date > as.Date(kirk_cousins_dates$Date[3]) & date <= as.Date(kirk_cousins_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(kirk_cousins_dates$Date[4]) & date <= as.Date(kirk_cousins_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(kirk_cousins_dates$Date[5]) & date <= as.Date(kirk_cousins_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(kirk_cousins_dates$Date[6]) & date <= as.Date(kirk_cousins_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
kirk_cousins_data <- kirk_cousins_tweets %>%
  left_join(kirk_cousins_logs, by="Week") %>%
  mutate(player="Kirk Cousins")


#LAMAR JACKSON
lamar_jackson <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/lamar_jackson.xlsx") 

#Wrangle gamelogs data
lamar_jackson_logs <- lamar_jackson %>%
  mutate(total_yards = pYds + rYds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pYds + 0.1*rYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
lamar_jackson_dates <- lamar_jackson_logs %>%
  select(Date)
#Twitter Scrape of Tweets
lamar_jackson_tweets <- get_timeline("@Lj_era8", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(lamar_jackson_dates$Date[1]), 1, 
                             ifelse(date > as.Date(lamar_jackson_dates$Date[1]) & date <= as.Date(lamar_jackson_dates$Date[2]), 2,
                                    ifelse(date > as.Date(lamar_jackson_dates$Date[2]) & date <= as.Date(lamar_jackson_dates$Date[3]), 3,
                                           ifelse(date > as.Date(lamar_jackson_dates$Date[3]) & date <= as.Date(lamar_jackson_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(lamar_jackson_dates$Date[4]) & date <= as.Date(lamar_jackson_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(lamar_jackson_dates$Date[5]) & date <= as.Date(lamar_jackson_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(lamar_jackson_dates$Date[6]) & date <= as.Date(lamar_jackson_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
lamar_jackson_data <- lamar_jackson_tweets %>%
  left_join(lamar_jackson_logs, by="Week") %>%
  mutate(player="Lamar Jackson")



#MATTHEW STAFFORD (HAS NOT TWEETED SINCE 2011)
matthew_stafford <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/matthew_stafford.xlsx")    
#Wrangle gamelogs data
matthew_stafford_logs <- matthew_stafford %>%
  mutate(total_yards = pYds + rYds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pYds + 0.1*rYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
matthew_stafford_dates <- matthew_stafford_logs %>%
  select(Date)
#Twitter Scrape of Tweets
matthew_stafford_tweets <- get_timeline("@matt_stafford9", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(matthew_stafford_dates$Date[1]), 1, 
                             ifelse(date > as.Date(matthew_stafford_dates$Date[1]) & date <= as.Date(matthew_stafford_dates$Date[2]), 2,
                                    ifelse(date > as.Date(matthew_stafford_dates$Date[2]) & date <= as.Date(matthew_stafford_dates$Date[3]), 3,
                                           ifelse(date > as.Date(matthew_stafford_dates$Date[3]) & date <= as.Date(matthew_stafford_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(matthew_stafford_dates$Date[4]) & date <= as.Date(matthew_stafford_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(matthew_stafford_dates$Date[5]) & date <= as.Date(matthew_stafford_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(matthew_stafford_dates$Date[6]) & date <= as.Date(matthew_stafford_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
matthew_stafford_data <- matthew_stafford_tweets %>%
  left_join(matthew_stafford_logs, by="Week") %>%
  mutate(player="Matthew Stafford")


#PHILIP RIVERS
philip_rivers <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/philip_rivers.xlsx")    
#Wrangle gamelogs data
philip_rivers_logs <- philip_rivers %>%
  mutate(total_yards = pYds + rYds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pYds + 0.1*rYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
philip_rivers_dates <- philip_rivers_logs %>%
  select(Date)
#Twitter Scrape of Tweets
philip_rivers_tweets <- get_timeline("@FauxPhilipRiver", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(philip_rivers_dates$Date[1]), 1, 
                             ifelse(date > as.Date(philip_rivers_dates$Date[1]) & date <= as.Date(philip_rivers_dates$Date[2]), 2,
                                    ifelse(date > as.Date(philip_rivers_dates$Date[2]) & date <= as.Date(philip_rivers_dates$Date[3]), 3,
                                           ifelse(date > as.Date(philip_rivers_dates$Date[3]) & date <= as.Date(philip_rivers_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(philip_rivers_dates$Date[4]) & date <= as.Date(philip_rivers_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(philip_rivers_dates$Date[5]) & date <= as.Date(philip_rivers_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(philip_rivers_dates$Date[6]) & date <= as.Date(philip_rivers_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
philip_rivers_data <- philip_rivers_tweets %>%
  left_join(philip_rivers_logs, by="Week") %>%
  mutate(player="Philip Rivers")


#RYAN TANNEHILL 
ryan_tannehill <- read_excel("~/Desktop/Data Science/Stat231JackDove/gamelogs/ryan_tannehill.xlsx")    
#Wrangle gamelogs data
ryan_tannehill_logs <- ryan_tannehill %>%
  mutate(total_yards = pYds + rYds) %>%
  mutate(total_tds = pTD + rTD) %>%
  mutate(fpts = 4*pTD + 6*rTD + .04*pYds + 0.1*rYds - 2*Int - 2*Fmb) %>%
  select(Date, Week, Rate, total_yards, total_tds, fpts) %>%
  mutate(Week = as.numeric(1:n()))
#Dates from Game Logs (used in merge with twitter data)
ryan_tannehill_dates <- ryan_tannehill_logs %>%
  select(Date)
#Twitter Scrape of Tweets
ryan_tannehill_tweets <- get_timeline("@ryantannehill1", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-09-01")) %>%
  select(created_at, date, text) %>% 
  #Assigning week number to player (in this case, 7 weeks) NOTE: Instead of dealing with bye weeks, week means team game (1-16), not NFL week (1-17)
  mutate(
    Week = as.numeric(ifelse(date < as.Date(ryan_tannehill_dates$Date[1]), 1, 
                             ifelse(date > as.Date(ryan_tannehill_dates$Date[1]) & date <= as.Date(ryan_tannehill_dates$Date[2]), 2,
                                    ifelse(date > as.Date(ryan_tannehill_dates$Date[2]) & date <= as.Date(ryan_tannehill_dates$Date[3]), 3,
                                           ifelse(date > as.Date(ryan_tannehill_dates$Date[3]) & date <= as.Date(ryan_tannehill_dates$Date[4]), 4,
                                                  ifelse(date > as.Date(ryan_tannehill_dates$Date[4]) & date <= as.Date(ryan_tannehill_dates$Date[5]), 5,
                                                         ifelse(date > as.Date(ryan_tannehill_dates$Date[5]) & date <= as.Date(ryan_tannehill_dates$Date[6]), 6,
                                                                ifelse(date > as.Date(ryan_tannehill_dates$Date[6]) & date <= as.Date(ryan_tannehill_dates$Date[7]), 7, "error")))))))
                      
    )) %>%
  filter(Week !="error") %>%
  group_by(Week) %>%
  summarize(tweetcount = n())
#Combined football and twitter data
ryan_tannehill_data <- ryan_tannehill_tweets %>%
  left_join(ryan_tannehill_logs, by="Week") %>%
  mutate(player="Ryan Tannehill")





#COMBINED QB DATA + ANALYSIS 


#Overall Week Points for All QBs

#QB Data points combined
qb_overall_data <- Kyler_Murray_data %>%
  full_join(Drew_Brees_data) %>%
  full_join(Russell_Wilson_data) %>%
  full_join(Gardner_Minshew_data) %>%
  full_join(Baker_Mayfield_data) %>%
  full_join(Teddy_Bridgewater_data) %>%
  full_join(Daniel_Jones_data) %>%
  full_join(Ben_Roethlisberger_data) %>%
  full_join(joe_burrow_data) %>%
  full_join(matt_ryan_data) %>%
  full_join(tom_brady_data) %>%
  full_join(carson_wentz_data) %>%
  full_join(jared_goff_data) %>%
  full_join(patrick_mahomes_data) %>%
  full_join(aaron_rodgers_data) %>%
  full_join(josh_allen_data) %>%
  full_join(derek_carr_data) %>%
  full_join(matthew_stafford_data) %>%
  full_join(philip_rivers_data) %>%
  full_join(lamar_jackson_data) %>%
  full_join(ryan_tannehill_data) %>%
  full_join(kirk_cousins_data) %>%
  select(tweetcount, fpts, Rate, total_yards, total_tds)

#scatterplot of all relevant weeks for all QBs: tweets vs. fantasy points
ggplot(qb_overall_data, aes(
  x=log(tweetcount),
  y=fpts
)) + geom_point() + geom_smooth() 

#Correlation matrix of those points
cor(qb_overall_data)

#Individual QB Correlation Coefficients + Plot

roethlisberger_cor_data <- Ben_Roethlisberger_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
roethlisberger_cor<- cor(roethlisberger_cor_data$fpts, roethlisberger_cor_data$tweetcount)

bridgewater_cor_data <- Teddy_Bridgewater_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
bridgewater_cor<- cor(bridgewater_cor_data$fpts, bridgewater_cor_data$tweetcount)

mayfield_cor_data <- Baker_Mayfield_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
mayfield_cor<- cor(mayfield_cor_data$fpts, mayfield_cor_data$tweetcount)

minshew_cor_data <- Gardner_Minshew_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
minshew_cor<- cor(minshew_cor_data$fpts, minshew_cor_data$tweetcount)

brees_cor_data <- Drew_Brees_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
brees_cor<- cor(brees_cor_data$fpts, brees_cor_data$tweetcount)

wilson_cor_data <- Russell_Wilson_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
wilson_cor<- cor(wilson_cor_data$fpts, wilson_cor_data$tweetcount)

murray_cor_data <- Kyler_Murray_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
murray_cor<- cor(murray_cor_data$fpts, murray_cor_data$tweetcount)

burrow_cor_data <- joe_burrow_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
burrow_cor<- cor(burrow_cor_data$fpts, burrow_cor_data$tweetcount)

brady_cor_data <- tom_brady_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
brady_cor<- cor(brady_cor_data$fpts, brady_cor_data$tweetcount)

ryan_cor_data <- matt_ryan_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
ryan_cor<- cor(ryan_cor_data$fpts, ryan_cor_data$tweetcount)

wentz_cor_data <- carson_wentz_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
wentz_cor<- cor(wentz_cor_data$fpts, wentz_cor_data$tweetcount)

goff_cor_data <- jared_goff_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
goff_cor<- cor(goff_cor_data$fpts, goff_cor_data$tweetcount)

mahomes_cor_data <- patrick_mahomes_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
mahomes_cor<- cor(mahomes_cor_data$fpts, mahomes_cor_data$tweetcount)

rodgers_cor_data <- aaron_rodgers_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
rodgers_cor<- cor(rodgers_cor_data$fpts, rodgers_cor_data$tweetcount)

allen_cor_data <- josh_allen_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
allen_cor<- cor(allen_cor_data$fpts, allen_cor_data$tweetcount)

carr_cor_data <- derek_carr_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
carr_cor<- cor(carr_cor_data$fpts, carr_cor_data$tweetcount)

stafford_cor_data <- matthew_stafford_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
stafford_cor<- cor(stafford_cor_data$fpts, stafford_cor_data$tweetcount)

rivers_cor_data <- philip_rivers_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
rivers_cor<- cor(rivers_cor_data$fpts, rivers_cor_data$tweetcount)

jackson_cor_data <- lamar_jackson_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
jackson_cor<- cor(jackson_cor_data$fpts, jackson_cor_data$tweetcount)

tannehill_cor_data <- ryan_tannehill_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
tannehill_cor<- cor(tannehill_cor_data$fpts, tannehill_cor_data$tweetcount)

cousins_cor_data <- kirk_cousins_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
cousins_cor<- cor(cousins_cor_data$fpts, cousins_cor_data$tweetcount)

names <- c("Ben Roethlisberger", "Teddy Bridgewater", "Baker Mayfield", "Russell Wilson", "Drew Brees", "Kyler Murray", 
            "Matt Ryan", "Tom Brady", "Carson Wentz", "Patrick Mahomes", "Aaron Rodgers", "Josh Allen", 
           "Derek Carr", "Lamar Jackson", "Kirk Cousins", "Ryan Tannehill", "Philip Rivers")

cors <- c(roethlisberger_cor, bridgewater_cor, mayfield_cor, wilson_cor, brees_cor, murray_cor, 
          ryan_cor, brady_cor, wentz_cor, mahomes_cor, rodgers_cor, allen_cor,
          carr_cor, jackson_cor, cousins_cor, tannehill_cor, rivers_cor)

QBtweetsfptscors <- data.frame(names, cors) %>%
  mutate(names = as.factor(names)) %>%
  arrange(cors)

ggplot(data=QBtweetsfptscors, aes(
  x=reorder(names, cors), y=cors, fill=cors) 
) + scale_fill_gradient(low="yellow",
                           high="red")+ geom_col() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), legend.position="none") +
  labs(x="Quarterback", y= "Correlation Coefficient", title = "2020 QB Tweet and Fantasy Point Correlations", subtitle = "Week Before Game's Tweet Counts vs. Game's Fantasy Points")


ryan_tannehill_data
#QB Tweet Comparison

#QB Total Tweets with names
qb_overall_tweets_byname <- Kyler_Murray_data %>%
  full_join(Drew_Brees_data) %>%
  full_join(Russell_Wilson_data) %>%
  full_join(Gardner_Minshew_data) %>%
  full_join(Baker_Mayfield_data) %>%
  full_join(Teddy_Bridgewater_data) %>%
  full_join(Daniel_Jones_data) %>%
  full_join(Ben_Roethlisberger_data) %>%
  full_join(joe_burrow_data) %>%
  full_join(matt_ryan_data) %>%
  full_join(tom_brady_data) %>%
  full_join(carson_wentz_data) %>%
  full_join(jared_goff_data) %>%
  full_join(patrick_mahomes_data) %>%
  full_join(aaron_rodgers_data) %>%
  full_join(josh_allen_data) %>%
  full_join(derek_carr_data) %>%
  full_join(matthew_stafford_data) %>%
  full_join(philip_rivers_data) %>%
  full_join(lamar_jackson_data) %>%
  full_join(ryan_tannehill_data) %>%
  full_join(kirk_cousins_data) %>%
  group_by(player) %>%
  summarize(count = sum(tweetcount)) %>%
  arrange(desc(count))

#QB Tweets chart 
ggplot(data=qb_overall_tweets_byname, aes(
  x=player, y=count
)) + geom_col() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))


#Scatterplot of QB average fpts and average tweetcount
qb_means <- Kyler_Murray_data %>%
  full_join(Drew_Brees_data) %>%
  full_join(Russell_Wilson_data) %>%
  full_join(Gardner_Minshew_data) %>%
  full_join(Baker_Mayfield_data) %>%
  full_join(Teddy_Bridgewater_data) %>%
  full_join(Daniel_Jones_data) %>%
  full_join(Ben_Roethlisberger_data) %>%
  full_join(joe_burrow_data) %>%
  full_join(matt_ryan_data) %>%
  full_join(tom_brady_data) %>%
  full_join(carson_wentz_data) %>%
  full_join(jared_goff_data) %>%
  full_join(patrick_mahomes_data) %>%
  full_join(aaron_rodgers_data) %>%
  full_join(josh_allen_data) %>%
  full_join(derek_carr_data) %>%
  full_join(matthew_stafford_data) %>%
  full_join(philip_rivers_data) %>%
  full_join(lamar_jackson_data) %>%
  full_join(ryan_tannehill_data) %>%
  full_join(kirk_cousins_data) %>%
  group_by(player) %>%
  summarize(avgtweetcount = mean(tweetcount), avgfpts = mean(fpts), avgtotal_yards = mean(total_yards), avgtotal_tds = mean(total_tds), avgRate = mean(Rate)) %>%
  arrange(desc(avgfpts/avgtweetcount))

library(plotly)
ggplotly(
ggplot(data= qb_means, aes(
  x=avgtweetcount,
  y=avgfpts,
  color=player
)) +geom_point() + theme(legend.position = "none"))


ben_roethlisberger_data_table <- Ben_Roethlisberger_data %>%
  select(Week, Date, tweetcount, total_tds, total_yards, Rate, fpts) %>%
  mutate(Date = as.Date(Date))
  

#NOTES

#Deshaun Watson (Private Account) and Daniel Jones (no tweets) were omitted from overall analysis.
#Gardner Minshew, Jared Goff, Joe Burrow, and Matthew Stafford were omitted from individual correlation analysis, as they lacked the tweet sample sizes to produce coefficients.
```

# Introduction

Many professional athletes use Twitter to promote their personal brand, support stances on social issues, or generally to express themselves on a global, immediate scale. It is sometimes forgotten that elite sports players are multidimensional people like everyone else; their social media accounts provide fans with insights into the opinions and personal lives of their favorite players. 

The rise of athletes' social media usage brings about a key question: is there a link between social media activity and sports performance?

Previous analyses have considered the effects of social media use the night before a game. In a [University of Chicago study](https://exsci.cuchicago.edu/study-shows-late-night-social-media-use-may-decrease-athletic-performance/), researchers measured the Twitter time usage of 112 National Basketball Association (NBA) players, and found a significant negative correlation between on-court performance and Twitter screen time. Some journalists even consider social media an [addiction](https://bleacherreport.com/articles/2798257) for athletes which can hinder their excellence during gametime. NBA superstar LeBron James is famous for his anti-social media stance during crunch time; James does not touch his phone during the entirety of the playoffs to avoid distractions, a mode he calls ["Zero Dark Thirty-23."](https://bleacherreport.com/articles/2770595-lebron-james-commences-zero-dark-30-23-mode-with-martin-luther-king-jr-quote)

To gain a unique analytical perspective on the idea of a relationship between performance and social media activity, our group web scraped, wrangled, and analyzed both the on-field performance and Twitter activity of National Football League (NFL) quarterbacks. Our goal was to determine whether 2020 NFL starting quarterbacks displayed a correlation between game statistics (ESPN-standard fantasy points, quarterback rating, total yards, and total touchdowns) and twitter post volumes (during the week leading up to a game) for the first seven games of the 2020 NFL season. 

# Data

## Players

We selected quaterbacks using the following criteria and ended up with a final sample size of 20.

1. Started in at least 7 games
2. Has a public twitter account
3. Tweeted at least once since 9/1/20

## Tweets

Starting on September 1, 2020, NFL player tweets were web scraped and sorted by the weeks they led up to. For example, Pittsburg Steelers starting quarterback Ben Roethlisberger had a Week 2 tweet count (tweetcount) of 25 because he tweeted or retweeted posts 25 times between September 14 (his last game) and September 20 (his Week 2 game). 

## Performance Statistics

Quarterbacks' on-field performance was wrangled through ProFootballReference.com game logs and measured weekly by the following categories:

1. Total Touchdowns (total_tds): Sum of Passing and Rushing Touchdowns
2. Total Yards (total_yards): Sum of Passing and Rushing Yards
3. Quarterback Rating: (Rate): A [measure](https://www.espn.com/blog/statsinfo/post/_/id/123701/how-is-total-qbr-calculated-we-explain-our-quarterback-rating) of game situation-standardized quarterback performance based on values including passing yards, passing touchdowns, and turnovers. 
4. Fantasy Points (fpts): [ESPN](https://www.espn.com/fantasy/football/ffl/story?page=fflrulesstandardscoring) standard league fantasy points


## Sample Quarterback Wrangling

The 20 quarterbacks' data consisted of both tweet counts and the four performance statistics. Ben Roethlisberger's dataframe provides an example of the key measures we tracked. 

```{r echo=FALSE, warning=FALSE}
datatable(ben_roethlisberger_data_table)
```

# Results

## Twitter Usage Distribution

While the 20 qualifying quarterbacks tweeted on average about 7 times per week, the median weekly tweet count was about 2 per week, with an IQR of 8 tweets. The tweet count distribution was skewed by outlier Ben Roethlisberger, who tweeted 31 tweets per week. Only Roethlisberger, Patrick Mahomes, Philip Rivers, Teddy Bridgewater and Russell Wilson tweeted more than 10 times per week. 

```{r, echo=FALSE, include =FALSE, warning=FALSE}
#QB Total Tweets with names
qb_overall_tweets_byname <- Kyler_Murray_data %>%
  full_join(Drew_Brees_data) %>%
  full_join(Russell_Wilson_data) %>%
  full_join(Gardner_Minshew_data) %>%
  full_join(Baker_Mayfield_data) %>%
  full_join(Teddy_Bridgewater_data) %>%
  full_join(Daniel_Jones_data) %>%
  full_join(Ben_Roethlisberger_data) %>%
  full_join(joe_burrow_data) %>%
  full_join(matt_ryan_data) %>%
  full_join(tom_brady_data) %>%
  full_join(carson_wentz_data) %>%
  full_join(jared_goff_data) %>%
  full_join(patrick_mahomes_data) %>%
  full_join(aaron_rodgers_data) %>%
  full_join(josh_allen_data) %>%
  full_join(derek_carr_data) %>%
  full_join(matthew_stafford_data) %>%
  full_join(philip_rivers_data) %>%
  full_join(lamar_jackson_data) %>%
  full_join(ryan_tannehill_data) %>%
  full_join(kirk_cousins_data) %>%
  group_by(player) %>%
  summarize(count = sum(tweetcount)) %>%
  arrange(desc(count))

#Avg weekly tweets 
qb_tweet_distr <- qb_overall_tweets_byname %>%
  summarize(avgweeklytweets = median(count/7))
```

```{r, echo=FALSE, warning=FALSE}
#QB Tweets chart 

  ggplot(data=qb_overall_tweets_byname, aes(
  x=player, y=count/7, fill=player
)) + geom_col() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), legend.position="none") +labs(x="Quarterback", y="Number of Tweets per Week", title="Average Weekly Tweet Counts") 
```

## Performance Measures Summary

Average fantasy points, total yards, total touchdowns, and quarterback rating were all fairly normally distributed. Quarterbacks averaged 19 fantasy points, with a standard deviation of five points. A typical outing for a quarterback consisted of 286 (+/-) 40 total yards with 2 (+/-) 1 touchdowns and a 99 (+/-) 14 QBR. 

```{r, echo=FALSE, include=FALSE, warning=FALSE}
#Scatterplot of QB average fpts and average tweetcount
qb_means <- Kyler_Murray_data %>%
  full_join(Drew_Brees_data) %>%
  full_join(Russell_Wilson_data) %>%
  full_join(Gardner_Minshew_data) %>%
  full_join(Baker_Mayfield_data) %>%
  full_join(Teddy_Bridgewater_data) %>%
  full_join(Daniel_Jones_data) %>%
  full_join(Ben_Roethlisberger_data) %>%
  full_join(joe_burrow_data) %>%
  full_join(matt_ryan_data) %>%
  full_join(tom_brady_data) %>%
  full_join(carson_wentz_data) %>%
  full_join(jared_goff_data) %>%
  full_join(patrick_mahomes_data) %>%
  full_join(aaron_rodgers_data) %>%
  full_join(josh_allen_data) %>%
  full_join(derek_carr_data) %>%
  full_join(matthew_stafford_data) %>%
  full_join(philip_rivers_data) %>%
  full_join(lamar_jackson_data) %>%
  full_join(ryan_tannehill_data) %>%
  full_join(kirk_cousins_data) %>%
  group_by(player) %>%
  summarize(avgfpts = mean(fpts), avgtotal_yards = mean(total_yards), avgtotal_tds = mean(total_tds), avgRate = mean(Rate)) %>%
  select(avgfpts, avgtotal_yards, avgtotal_tds, avgRate)

favstats(~avgfpts, data=qb_means)
favstats(~avgtotal_yards, data=qb_means)
favstats(~avgtotal_tds, data=qb_means)
favstats(~avgRate, data=qb_means)

gf_histogram(~avgfpts, data=qb_means)
gf_histogram(~avgtotal_yards, data=qb_means)
gf_histogram(~avgtotal_tds, data=qb_means)
gf_histogram(~avgRate, data=qb_means)
```

#### Average Weekly Quarterback Total Distributions


```{r, echo=FALSE, warning=FALSE}
#Fantasy Points Distribution
fantasypoints <- ggplot(data=qb_means, aes(
  x= avgfpts
)) + geom_histogram(binwidth=1, fill="Red") + labs(x="Fantasy Points", y= "Number of Quarterbacks")

#Yards Points Distribution
totalyards <- ggplot(data=qb_means, aes(
  x= avgtotal_yards
)) + geom_histogram(binwidth=10, fill="Blue") + labs(x="Yards", y= "Number of Quarterbacks")

#Touchdowns Distribution
totaltouchdowns <- ggplot(data=qb_means, aes(
  x= avgtotal_tds
)) + geom_histogram(binwidth=0.2, fill="Orange") + labs(x="Touchdowns", y= "Number of Quarterbacks")

#QBR Distribution
qbr <- ggplot(data=qb_means, aes(
  x= avgRate
)) + geom_histogram(binwidth=5, fill="Purple") + labs(x="QBR", y= "Number of Quarterbacks")

grid.arrange(fantasypoints, totalyards, totaltouchdowns, qbr, ncol=2)
```

## Overall Trends

```{r, echo=FALSE, include=FALSE, warning=FALSE}
#Scatterplot of QB average fpts and average tweetcount
qb_means <- Kyler_Murray_data %>%
  full_join(Drew_Brees_data) %>%
  full_join(Russell_Wilson_data) %>%
  full_join(Gardner_Minshew_data) %>%
  full_join(Baker_Mayfield_data) %>%
  full_join(Teddy_Bridgewater_data) %>%
  full_join(Daniel_Jones_data) %>%
  full_join(Ben_Roethlisberger_data) %>%
  full_join(joe_burrow_data) %>%
  full_join(matt_ryan_data) %>%
  full_join(tom_brady_data) %>%
  full_join(carson_wentz_data) %>%
  full_join(jared_goff_data) %>%
  full_join(patrick_mahomes_data) %>%
  full_join(aaron_rodgers_data) %>%
  full_join(josh_allen_data) %>%
  full_join(derek_carr_data) %>%
  full_join(matthew_stafford_data) %>%
  full_join(philip_rivers_data) %>%
  full_join(lamar_jackson_data) %>%
  full_join(ryan_tannehill_data) %>%
  full_join(kirk_cousins_data) 

cordata <- qb_means %>%
  select(tweetcount, fpts, total_yards, total_tds, Rate) %>%
  mutate(logtweetcount = log(tweetcount)) %>%
  select(logtweetcount, fpts, total_yards, total_tds, Rate)

cor(cordata)



# Fantasy Points vs. Tweet Count
fpts_plot <- ggplot(data= qb_means, aes(
  x=log(tweetcount),
  y=fpts
)) +geom_point(color="Red") + theme(legend.position = "none") + labs(x="Log(Tweet Count)", y="Fantasy Points") + geom_smooth(method="lm", color="Red")

# Total Yards vs. Tweet Count
yards_plot <- ggplot(data= qb_means, aes(
  x=log(tweetcount),
  y=total_yards
)) +geom_point(color="Blue") + theme(legend.position = "none") + labs(x="Log(Tweet Count)", y="Total Yards") + geom_smooth(method="lm", color="Blue") 

# Total Touchdowns vs. Tweet Count
tds_plot <- ggplot(data= qb_means, aes(
  x=log(tweetcount),
  y=total_tds
)) +geom_point(color="Orange") + theme(legend.position = "none") + labs(x="Log(Tweet Count)", y="Total Touchdowns") + geom_smooth(method="lm", color="Orange") 

# QBR vs. Tweet Count
rating_plot <- ggplot(data= qb_means, aes(
  x=log(tweetcount),
  y=Rate
)) +geom_point(color="Purple") + theme(legend.position = "none") + labs(x="Log(Tweet Count)", y="QBR") + geom_smooth(method="lm", color="Purple") 
```

To gain an overview of the link between Twitter usage and on-field performance, we first graphically analyzed the relationships between the log of a player's tweets that week and their corresponding playing statistic using all weeks from all eligible players. All four performance measurements displayed positive but weak relationships with the log of tweet counts.  

### Fantasy Points vs. Log of Tweet Count

Registering a correlation coefficient of 0.19, fantasy points and log(tweetcount) displayed a moderate, positive relationship. As displayed by the upward sloping trend line, the plot suggests some association between fantasy points and the log of pre-game week tweet counts. 

```{r, echo=FALSE, warning=FALSE, message=FALSE}
fpts_plot
```

### Total Yards vs. Log of Tweet Count

The relationship between total yards and log(tweetcount) is minimal, with a barely upward sloping trendline and a correlation coefficient of 0.06. This data points at a very weak link between total yards and the log of tweet counts. 
```{r, echo=FALSE, warning=FALSE, message=FALSE}
yards_plot
```

### Total Touchdowns vs. Log of Tweet Count

Supported by a correlation coefficient of 0.19, total touchdowns displayed a small, positive relationship with tweet count. As visibible in the chart below, there were slightly more high touchdown performances for quarterbacks who tweeted above the median amount of two tweets.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
tds_plot 
```

### Quarterback Rating  vs. Log of Tweet Count

The strongest overall trend between a performance measure and social media activity was that of quarterback rating and tweet counts. With a correlation coefficient of 0.23 and a moderately upward trendline, the data displays a weak to medium, positive relationship between quarterback rating and tweet count. 

```{r, echo=FALSE, warning=FALSE, message=FALSE}
rating_plot
```

## Individual Correlation Comparison

To see which quarterbacks displayed the highest magnitudes of association between their performance and their social media usage, we compared their personal correlation coefficients relating their on-field statistics and tweet counts.

According to the below chart of individual correlation coefficients, about 75 percent of our sample of 20 quarterbacks falls in the small to medium positive relationship category between fantasy points and tweet counts. Ryan Tannehill had the highest correlation coefficient at 0.91, suggesting that 82 percent of the differences in his fantasy points can be associated with differences in his pre-game week tweet volumes. 

```{r, echo=FALSE, include=FALSE, warning=FALSE}
#Individual QB Correlation Coefficients + Plot

roethlisberger_cor_data <- Ben_Roethlisberger_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
roethlisberger_cor<- cor(roethlisberger_cor_data$fpts, roethlisberger_cor_data$tweetcount)

bridgewater_cor_data <- Teddy_Bridgewater_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
bridgewater_cor<- cor(bridgewater_cor_data$fpts, bridgewater_cor_data$tweetcount)

mayfield_cor_data <- Baker_Mayfield_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
mayfield_cor<- cor(mayfield_cor_data$fpts, mayfield_cor_data$tweetcount)

minshew_cor_data <- Gardner_Minshew_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
minshew_cor<- cor(minshew_cor_data$fpts, minshew_cor_data$tweetcount)

brees_cor_data <- Drew_Brees_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
brees_cor<- cor(brees_cor_data$fpts, brees_cor_data$tweetcount)

wilson_cor_data <- Russell_Wilson_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
wilson_cor<- cor(wilson_cor_data$fpts, wilson_cor_data$tweetcount)

murray_cor_data <- Kyler_Murray_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
murray_cor<- cor(murray_cor_data$fpts, murray_cor_data$tweetcount)

burrow_cor_data <- joe_burrow_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
burrow_cor<- cor(burrow_cor_data$fpts, burrow_cor_data$tweetcount)

brady_cor_data <- tom_brady_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
brady_cor<- cor(brady_cor_data$fpts, brady_cor_data$tweetcount)

ryan_cor_data <- matt_ryan_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
ryan_cor<- cor(ryan_cor_data$fpts, ryan_cor_data$tweetcount)

wentz_cor_data <- carson_wentz_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
wentz_cor<- cor(wentz_cor_data$fpts, wentz_cor_data$tweetcount)

goff_cor_data <- jared_goff_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
goff_cor<- cor(goff_cor_data$fpts, goff_cor_data$tweetcount)

mahomes_cor_data <- patrick_mahomes_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
mahomes_cor<- cor(mahomes_cor_data$fpts, mahomes_cor_data$tweetcount)

rodgers_cor_data <- aaron_rodgers_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
rodgers_cor<- cor(rodgers_cor_data$fpts, rodgers_cor_data$tweetcount)

allen_cor_data <- josh_allen_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
allen_cor<- cor(allen_cor_data$fpts, allen_cor_data$tweetcount)

carr_cor_data <- derek_carr_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
carr_cor<- cor(carr_cor_data$fpts, carr_cor_data$tweetcount)

stafford_cor_data <- matthew_stafford_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
stafford_cor<- cor(stafford_cor_data$fpts, stafford_cor_data$tweetcount)

rivers_cor_data <- philip_rivers_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
rivers_cor<- cor(rivers_cor_data$fpts, rivers_cor_data$tweetcount)

jackson_cor_data <- lamar_jackson_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
jackson_cor<- cor(jackson_cor_data$fpts, jackson_cor_data$tweetcount)

tannehill_cor_data <- ryan_tannehill_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
tannehill_cor<- cor(tannehill_cor_data$fpts, tannehill_cor_data$tweetcount)

cousins_cor_data <- kirk_cousins_data %>%
  select(fpts, Rate, total_tds, total_yards, tweetcount)
cousins_cor<- cor(cousins_cor_data$fpts, cousins_cor_data$tweetcount)

names <- c("Ben Roethlisberger", "Teddy Bridgewater", "Baker Mayfield", "Russell Wilson", "Drew Brees", "Kyler Murray", 
            "Matt Ryan", "Tom Brady", "Carson Wentz", "Patrick Mahomes", "Aaron Rodgers", "Josh Allen", 
           "Derek Carr", "Lamar Jackson", "Kirk Cousins", "Ryan Tannehill", "Philip Rivers")

cors <- c(roethlisberger_cor, bridgewater_cor, mayfield_cor, wilson_cor, brees_cor, murray_cor, 
          ryan_cor, brady_cor, wentz_cor, mahomes_cor, rodgers_cor, allen_cor,
          carr_cor, jackson_cor, cousins_cor, tannehill_cor, rivers_cor)

QBtweetsfptscors <- data.frame(names, cors) %>%
  mutate(names = as.factor(names)) %>%
  arrange(cors)

indiv_cor_plot <- ggplot(data=QBtweetsfptscors, aes(
  x=reorder(names, cors), y=cors, fill=cors) 
) + scale_fill_gradient(low="yellow",
                           high="red")+ geom_col() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), legend.position="none") +
  labs(x="Quarterback", y= "Correlation Coefficient", title = "2020 QB Tweet and Fantasy Point Correlations", subtitle = "Week Before Game's Tweet Counts vs. Game's Fantasy Points")

#Linear Model Analyses

#Ben_Roethlisberger
Ben_Roethlisberger_model <- lm(fpts ~ tweetcount, data=Ben_Roethlisberger_data)
Ben_Roethlisberger_coef <- summary(Ben_Roethlisberger_model)$coeff["tweetcount","Estimate"]
Ben_Roethlisberger_r2 <- summary(Ben_Roethlisberger_model)$r.squared
Ben_Roethlisberger_pVal <- anova(Ben_Roethlisberger_model)$'Pr(>F)'[1]

#Teddy Bridgewater
Teddy_Bridgwater_model <- lm(fpts ~ tweetcount, data=Teddy_Bridgewater_data)
Teddy_Bridgwater_coef <- summary(Teddy_Bridgwater_model)$coeff["tweetcount","Estimate"]
Teddy_Bridgwater_r2 <- summary(Teddy_Bridgwater_model)$r.squared
Teddy_Bridgwater_pVal <- anova(Teddy_Bridgwater_model)$'Pr(>F)'[1]

#Baker Mayfield
Baker_Mayfield_model <- lm(fpts ~ tweetcount, data=Baker_Mayfield_data)
Baker_Mayfield_coef <- summary(Baker_Mayfield_model)$coeff["tweetcount","Estimate"]
Baker_Mayfield_r2 <- summary(Baker_Mayfield_model)$r.squared
Baker_Mayfield_pVal <- anova(Baker_Mayfield_model)$'Pr(>F)'[1]

#Russell Wilson
Russell_Wilson_model <- lm(fpts ~ tweetcount, data=Russell_Wilson_data)
Russell_Wilson_coef <- summary(Russell_Wilson_model)$coeff["tweetcount","Estimate"]
Russell_Wilson_r2 <- summary(Russell_Wilson_model)$r.squared
Russell_Wilson_pVal <- anova(Russell_Wilson_model)$'Pr(>F)'[1]

#Drew Brees
Drew_Brees_model <- lm(fpts ~ tweetcount, data=Drew_Brees_data)
Drew_Brees_coef <- summary(Drew_Brees_model)$coeff["tweetcount","Estimate"]
Drew_Brees_r2 <- summary(Drew_Brees_model)$r.squared
Drew_Brees_pVal <- anova(Drew_Brees_model)$'Pr(>F)'[1]

#Kyler Murray
Kyler_Murray_model <- lm(fpts ~ tweetcount, data=Kyler_Murray_data)
Kyler_Murray_coef <- summary(Kyler_Murray_model)$coeff["tweetcount","Estimate"]
Kyler_Murray_r2 <- summary(Kyler_Murray_model)$r.squared
Kyler_Murray_pVal <- anova(Kyler_Murray_model)$'Pr(>F)'[1]

#Matt Ryan
matt_ryan_model <- lm(fpts ~ tweetcount, data=matt_ryan_data)
matt_ryan_coef <- summary(matt_ryan_model)$coeff["tweetcount","Estimate"]
matt_ryan_r2 <- summary(matt_ryan_model)$r.squared
matt_ryan_pVal <- anova(matt_ryan_model)$'Pr(>F)'[1]

#Tom Brady
tom_brady_model <- lm(fpts ~ tweetcount, data=tom_brady_data)
tom_brady_coef <- summary(tom_brady_model)$coeff["tweetcount","Estimate"]
tom_brady_r2 <- summary(tom_brady_model)$r.squared
tom_brady_pVal <- anova(tom_brady_model)$'Pr(>F)'[1]

#Carson Wentz
carson_wentz_model <- lm(fpts ~ tweetcount, data=carson_wentz_data)
carson_wentz_coef <- summary(carson_wentz_model)$coeff["tweetcount","Estimate"]
carson_wentz_r2 <- summary(carson_wentz_model)$r.squared
carson_wentz_pVal <- anova(carson_wentz_model)$'Pr(>F)'[1]

#Patrick Mahomes
patrick_mahomes_model <- lm(fpts ~ tweetcount, data=patrick_mahomes_data)
patrick_mahomes_coef <- summary(patrick_mahomes_model)$coeff["tweetcount","Estimate"]
patrick_mahomes_r2 <- summary(patrick_mahomes_model)$r.squared
patrick_mahomes_pVal <- anova(patrick_mahomes_model)$'Pr(>F)'[1]

#Aaron Rodgers
aaron_rodgers_model <- lm(fpts ~ tweetcount, data=aaron_rodgers_data)
aaron_rodgers_coef <- summary(aaron_rodgers_model)$coeff["tweetcount","Estimate"]
aaron_rodgers_r2 <- summary(aaron_rodgers_model)$r.squared
aaron_rodgers_pVal <- anova(aaron_rodgers_model)$'Pr(>F)'[1]

#Josh Allen
josh_allen_model <- lm(fpts ~ tweetcount, data=josh_allen_data)
josh_allen_coef <- summary(josh_allen_model)$coeff["tweetcount","Estimate"]
josh_allen_r2 <- summary(josh_allen_model)$r.squared
josh_allen_pVal <- anova(josh_allen_model)$'Pr(>F)'[1]

#Derek Carr
derek_carr_model <- lm(fpts ~ tweetcount, data=derek_carr_data)
derek_carr_coef <- summary(derek_carr_model)$coeff["tweetcount","Estimate"]
derek_carr_r2 <- summary(derek_carr_model)$r.squared
derek_carr_pVal <- anova(derek_carr_model)$'Pr(>F)'[1]

#Lamar Jackson
lamar_jackson_model <- lm(fpts ~ tweetcount, data=lamar_jackson_data)
lamar_jackson_coef <- summary(lamar_jackson_model)$coeff["tweetcount","Estimate"]
lamar_jackson_r2 <- summary(lamar_jackson_model)$r.squared
lamar_jackson_pVal <- anova(lamar_jackson_model)$'Pr(>F)'[1]

#Kirk Cousins
kirk_cousins_model <- lm(fpts ~ tweetcount, data=kirk_cousins_data)
kirk_cousins_coef <- summary(kirk_cousins_model)$coeff["tweetcount","Estimate"]
kirk_cousins_r2 <- summary(kirk_cousins_model)$r.squared
kirk_cousins_pVal <- anova(kirk_cousins_model)$'Pr(>F)'[1]

#Ryan Tannehill
ryan_tannehill_model <- lm(fpts ~ tweetcount, data=ryan_tannehill_data)
ryan_tannehill_coef <- summary(ryan_tannehill_model)$coeff["tweetcount","Estimate"]
ryan_tannehill_r2 <- summary(ryan_tannehill_model)$r.squared
ryan_tannehill_pVal <- anova(ryan_tannehill_model)$'Pr(>F)'[1]

#Philip Rivers
philip_rivers_model <- lm(fpts ~ tweetcount, data=philip_rivers_data)
philip_rivers_coef <- summary(philip_rivers_model)$coeff["tweetcount","Estimate"]
philip_rivers_r2 <- summary(philip_rivers_model)$r.squared
philip_rivers_pVal <- anova(philip_rivers_model)$'Pr(>F)'[1]

names <- c("Ben Roethlisberger", "Teddy Bridgewater", "Baker Mayfield", "Russell Wilson", "Drew Brees", "Kyler Murray", 
            "Matt Ryan", "Tom Brady", "Carson Wentz", "Patrick Mahomes", "Aaron Rodgers", "Josh Allen", 
           "Derek Carr", "Lamar Jackson", "Kirk Cousins", "Ryan Tannehill", "Philip Rivers")

coefs <- c(Ben_Roethlisberger_coef, Teddy_Bridgwater_coef, Baker_Mayfield_coef, Russell_Wilson_coef, Drew_Brees_coef, Kyler_Murray_coef, matt_ryan_coef, tom_brady_coef, carson_wentz_coef, patrick_mahomes_coef, aaron_rodgers_coef, josh_allen_coef, derek_carr_coef, lamar_jackson_coef, kirk_cousins_coef, ryan_tannehill_coef, philip_rivers_coef)

r2s <- c(Ben_Roethlisberger_r2, Teddy_Bridgwater_r2, Baker_Mayfield_r2, Russell_Wilson_r2, Drew_Brees_r2, Kyler_Murray_r2, matt_ryan_r2, tom_brady_r2, carson_wentz_r2, patrick_mahomes_r2, aaron_rodgers_r2, josh_allen_r2, derek_carr_r2, lamar_jackson_r2, kirk_cousins_r2, ryan_tannehill_r2, philip_rivers_r2)

ps <- c(Ben_Roethlisberger_pVal, Teddy_Bridgwater_pVal, Baker_Mayfield_pVal, Russell_Wilson_pVal, Drew_Brees_pVal, Kyler_Murray_pVal, matt_ryan_pVal, tom_brady_pVal, carson_wentz_pVal, patrick_mahomes_pVal, aaron_rodgers_pVal, josh_allen_pVal, derek_carr_pVal, lamar_jackson_pVal, kirk_cousins_pVal, ryan_tannehill_pVal, philip_rivers_pVal)

QBtweetsfptsmodels <- data.frame(names, coefs, r2s, ps) %>%
  mutate(signif = ifelse(ps < 0.05, "yes", "no")) %>%
  mutate(r2s = round(r2s, digits=2))

indiv_model_plot <- ggplot(data=QBtweetsfptsmodels, aes(
  x=reorder(names, ps), y=coefs, fill=ps, text=paste0("R Squared: ", r2s)) 
) + scale_fill_gradient(low="yellow",
                           high="red")+ geom_col() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs(x="Quarterback", y= "Coefficient", fill= "P Value", title = "2020 QB Tweet and Fantasy Point Linear Regression Coefficients")

interactivemodelplot <- ggplotly(indiv_model_plot, tooltip = "text")
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
indiv_cor_plot
```

## Individual Linear Regression Model Comparison

We used simple linear regression to measure both the strength and validitiy of the fantasy point and tweet count relationship. Coefficients represent the number of additional fantasy points associated with one tweet during the week prior to a game. Only two models were significant at a significance level of 0.10 (Patrick Mahomes and Ryan Tannehill), with the average p value being 0.58. The average coefficient was 1.01 with a standard deviation of 2.00; because zero is within one standard deviation of the mean coefficient value, is it difficult to point to any major associations between fantasy points and tweet counts for these individual quarterback models. 

```{r, echo=FALSE, warning=FALSE, message=FALSE}
interactivemodelplot
```

## Case Study Prediction: Patrick Mahomes

To truly test our models, legimitate testing and training would be completed; however, for a sample of that testing process, we used our most statistically significant linear regression model (Patrick Mahomes) and predicted his Week 8 fantasy point totals. 

This model predicted Patrick Mahomes to score 24.45 points during Week 8, which makes sense, as his tweet count of 18 was just below his mean of 18.50, and 24.45 points falls just shy of his average fantasy score of 25.11. 

Patrick Mahomes ended up scoring 36.64 points during Week 8, giving a high level of error at 49 percent. While this result is not enticing, it displays both the limitations of our small sample size and the multitude of variables affecting NFL performance data (Mahomes played the New York Jets during Week 8, who have given up the 3rd most fantasy points to quarterbacks of all defenses this year). 

$$ \hat{fpts} = \beta_1\times(tweetcount) + \beta_0 $$
$$ Patrick\;Mahomes\;Predicted\;Week\;8\;Fantasy\;Points = 1.02\times(18) + 6.09 = 24.45 $$
$$ Percent\;Error = \frac{36.64 - 24.45}{24.45} = 49.85\%$$
```{r, echo=FALSE, warning=FALSE, include=FALSE, message=FALSE}
patrick_mahomes_tweets_forpredict <- get_timeline("@patrickmahomes", n=1000) %>%
  mutate(date = as.Date(created_at)) %>% 
  filter(date > as.Date("2020-10-25")) %>%
  filter(date < as.Date("2020-11-01")) %>%
  summarise(tweetcount = n())

mean(patrick_mahomes_data$fpts)
mean(patrick_mahomes_data$tweetcount)

predict(patrick_mahomes_model, newdata=patrick_mahomes_tweets_forpredict)
patrick_mahomes_data$fpts[8]
```
